"""
Pandas-compatible result structures for DQX.

This module provides result classes that mirror the Spark-based DQCheckResult
but work with Pandas DataFrames and Series.
"""

from dataclasses import dataclass
from typing import Union, Any
import pandas as pd


@dataclass(frozen=True)
class PandasDQCheckResult:
    """
    Pandas-compatible version of DQCheckResult.
    
    Represents the result of applying a data quality rule to a Pandas DataFrame.
    
    This class holds:
    - The Pandas Series containing the result of the data quality check
      (typically boolean mask or message series indicating rule violations).
    - The DataFrame that was evaluated or generated by the check.
    """
    
    condition: Union[pd.Series, Any]  # Boolean mask, message series, or condition result
    check_df: pd.DataFrame            # DataFrame after applying the check
    
    def __post_init__(self):
        """Validate the result structure."""
        if not isinstance(self.check_df, pd.DataFrame):
            raise TypeError("check_df must be a pandas DataFrame")
        
        # condition can be various types depending on the check type
        # For row-level checks: typically a pd.Series
        # For dataset-level checks: could be other types
        if isinstance(self.condition, pd.Series):
            if len(self.condition) != len(self.check_df):
                raise ValueError("condition Series length must match DataFrame length")
